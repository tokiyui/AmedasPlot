<!DOCTYPE html>
<html>
<head>
  <title>METARステーションデータ</title>
  <script>
    function fetchMETAR() {
      var stations = ["RJSN", "RJNT", "RJNW", "RJNK"];
      var baseUrl = "https://aviationweather.gov/cgi-bin/data/metar.cgi?ids=";

      var metarData = "";

      for (var i = 0; i < stations.length; i++) {
        var url = baseUrl + stations[i];

        fetch(url)
          .then(response => response.text())
          .then(data => {
            // METARデータを取得した後の処理
            var lines = data.split("\n");
            var metar = "";

            for (var j = 0; j < lines.length; j++) {
              if (lines[j].startsWith(stations[i])) {
                metar = lines[j];
                break;
              }
            }

            metarData += "<h2>" + stations[i] + "</h2>";
            metarData += "<pre>" + metar + "</pre>";

            if (i === stations.length - 1) {
              // 最後のステーションのデータを取得した後、HTMLに表示
              document.getElementById("metarContainer").innerHTML = metarData;
            }
          })
          .catch(error => {
            // エラーハンドリング
            console.log("エラーが発生しました:", error);
          });
      }
    }
  </script>
</head>
<body>
  <button onclick="fetchMETAR()">METARデータを取得</button>
  <div id="metarContainer"></div>
</body>
</html>
